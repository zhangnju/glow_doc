<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Glow: Building the compiler</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Glow
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building the compiler </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document contains detailed information about building the compiler on different systems and with different options.</p>
<h2>Building with JIT/OpenCL Backends</h2>
<p>By default Glow builds with only the interpreter backend enabled. To enable support for the JIT and/or OpenCL backends, pass additional options to cmake:</p>
<div class="fragment"><div class="line">-DGLOW_WITH_CPU=1 -DGLOW_WITH_OPENCL=1</div></div><!-- fragment --><h3>OpenCL on Ubuntu</h3>
<p>If you decide to use OpenCL, the easiest way is to install portable open source implementation of the OpenCL standard, <a href="https://github.com/pocl/pocl">pocl</a>. Glow relies on pocl to run OpenCL tests on CI. All required steps are outlined in the <a href="https://github.com/pytorch/glow/blob/master/.circleci/build.sh#L9">install_pocl</a> method.</p>
<p>Alternatively, you can follow these steps:</p>
<ol type="1">
<li>Install necessary packages:</li>
</ol>
<div class="fragment"><div class="line">sudo apt-get install ocl-icd-opencl-dev ocl-icd-libopencl1 opencl-headers \</div><div class="line">    clinfo</div></div><!-- fragment --><ol type="1">
<li>Install the appropriate runtime for your CPU/GPU. This will depend on your hardware. If you have an Intel CPU with onboard graphics, you can navigate to Intel's compute-runtime releases page on Github at <a href="https://github.com/intel/compute-runtime/releases/">https://github.com/intel/compute-runtime/releases/</a> and follow their instructions. You will probably want to choose the latest release and then download and install about ~4 prebuilt packages. At the time of this writing, the prebuilt packages of compute-runtime Release 18.45.11804 ran successfully with Glow on an Intel Core i7-7600U running Ubuntu 16.04.1.</li>
<li>To determine if installation was successful, you can run the following command:</li>
</ol>
<div class="fragment"><div class="line">clinfo</div></div><!-- fragment --><p>This will display information about your OpenCL platforms and devices (if found). Lastly, build Glow with the cmake flag <code>-DGLOW_WITH_OPENCL=ON</code> and run the test <code>OCLTest</code>.</p>
<h3>Supporting multiple targets</h3>
<p>The JIT is able to target all environments supported by LLVM. If the <code>build_llvm.sh</code> script is used to build LLVM for Glow, all the currently stable architectures will be enabled. If you wish to control which architectures are built, you can use the <code>LLVM_TARGETS_TO_BUILD</code> cmake parameter when building LLVM.</p>
<h2>Building with the Sanitizers</h2>
<p>The clang-sanitizer project provides a number of libraries which can be used with compiler inserted instrumentation to find a variety of bugs at runtime. These include memory issues due such as use-after-free or double-free. They can also detect other types of problems like memory leaks. Glow can be built with the sanitizers enabled using an additional parameter to cmake.</p>
<p>The following sanitizers are currently configurable:</p>
<ul>
<li>Address</li>
<li>Memory</li>
<li>Undefined</li>
<li>Thread</li>
<li>Leaks</li>
</ul>
<p>You can pass one of the above as a value to the cmake parameter <code>GLOW_USE_SANITIZER</code>. <code>Address</code> and <code>Undefined</code> are special in that they may be enabled simultaneously by passing <code>Address;Undefined</code> as the value. Additionally, the <code>Memory</code> sanitizer can also track the origin of the memory which can be enabled by using <code>MemoryWithOrigins</code> instead of <code>Memory</code>.</p>
<h2>Building with clang-tidy</h2>
<p>The clang project provides an additional utility to scan your source code for possible issues. Enabling <code>clang-tidy</code> checks on the source code is easy and can be done by passing an additional cmake parameter during the configure step.</p>
<div class="fragment"><div class="line">-DCMAKE_CXX_CLANG_TIDY=$(which clang-tidy)</div></div><!-- fragment --><p>Adding this to the configure step will automatically run clang-tidy on the source tree during compilation. Use the following configuration to enable auto-fix and to enable/disable specific checks:</p>
<div class="fragment"><div class="line">-DCMAKE_CXX_CLANG_TIDY:STRING=&quot;$(which clang-tidy);-checks=...;-fix&quot;</div></div><!-- fragment --><h2>Building with coverage</h2>
<p>Glow uses gcov, lcov, and genhtml to generate coverage reports for the code base. Using this tool allows you to make sure that corner cases are covered with the unit tests as well as keep the unit test coverage at a healthy level. You can generate a coverage report by providing additional options to cmake:</p>
<div class="fragment"><div class="line">-DGLOW_USE_COVERAGE=1</div></div><!-- fragment --><p> and then invoke <code>glow_coverage</code> make target.</p>
<h2>Building Doxygen documentation</h2>
<p>Building documentation can be enabled by passing an additional cmake parameter:</p>
<div class="fragment"><div class="line">-DBUILD_DOCS=ON</div></div><!-- fragment --><p>The output will be placed in the <code>docs/html</code> subdirectory of the build output directory.</p>
<h2>Generate dependency graph for cmake targets</h2>
<p>Run cmake normally and then execute <code>dependency_graph</code> target. The <code>dependency_graph</code> file contains dependencies for all project targets. It might look a bit overwhelming, in that case you could check <code>dependency_graph.loader</code>, <code>dependency_graph.cifar10</code>, etc. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
